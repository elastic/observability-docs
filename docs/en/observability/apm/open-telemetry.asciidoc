[[apm-open-telemetry]]
== Use OpenTelemetry with APM

++++
<titleabbrev>Use OpenTelemetry</titleabbrev>
++++

https://opentelemetry.io/docs/concepts/what-is-opentelemetry/[OpenTelemetry] is a set of APIs, SDKs, tooling, and integrations that enable the capture and management of
telemetry data from your services and applications. For more information about the
OpenTelemetry project, see the https://github.com/open-telemetry/opentelemetry-specification/blob/master/README.md[spec].

// Improve wording?
// TODO: Update link when landing page is ready
[NOTE]
====
To learn more about using OpenTelemetry with Elastic _outside_ the context of APM,
refer to https://github.com/elastic/opentelemetry[Elastic + OpenTelemetry].
====

[float]
== OpenTelemetry and the {stack}

Elastic integrates with OpenTelemetry, allowing you to reuse your existing instrumentation
to easily send observability data to the {stack}.
There are several ways to integrate OpenTelemetry with the {stack}:

* <<apm-otel-elastic-distros,Elastic Distributions for OpenTelemetry>>
* <<apm-otel-api-sdk,OpenTelemetry API/SDK>>
* <<apm-otel-api-sdk-elastic-agent,OpenTelemetry API/SDK + Elastic APM agent>>
* <<apm-otel-collector,OpenTelemetry Collector>>
// TODO: Should this be reflected in the diagram, too?
* <<apm-otel-lambda,Lambda collector exporter>>

// TODO: Add links to Otel docs?
// [subs=attributes+]
// include::./diagrams/apm-otel-architecture.asciidoc[Architecture of Elastic APM with OpenTelemetry]

[float]
[[apm-otel-elastic-distros]]
=== Elastic Distributions for OpenTelemetry

Elastic offers several distributions for OpenTelemetry.
A _distribution_ is a customized version of an upstream OpenTelemetry repository with some customizations.
Each Elastic Distribution for OpenTelemetry is an extension around an https://opentelemetry.io/docs/languages/[OpenTelemetry Language API or SDK].

With an Elastic distro you have access to all the features of the OpenTelemetry API or SDK that it extends, plus:

* You may get access to API/SDK improvements and bug fixes contributed by the Elastic team _before_
the changes are available upstream in the OpenTelemetry repositories.
* The distro preconfigures the collection of tracing and metrics signals, applying some opinionated defaults,
such as which sources are collected by default.

image::images/apm-otel-distro.png[]

// TODO: Update links when distro docs are markdown-ified
Get started with an Elastic Distribution for OpenTelemetry:

* https://github.com/elastic/elastic-otel-java[Java]
* https://github.com/elastic/elastic-otel-dotnet[.NET]
* https://github.com/elastic/elastic-otel-node[Node.js]

[NOTE]
====
For more details about OpenTelemetry distributions in general,
visit the https://opentelemetry.io/docs/concepts/distributions[OpenTelemetry documentation].
====

[float]
[[apm-otel-api-sdk]]
=== OpenTelemetry API/SDK

The {stack} natively supports the OpenTelemetry protocol (OTLP).
This means trace data and metrics collected from your applications and infrastructure by an
OpenTelemetry agent can be sent directly to the {stack}.

<<apm-instrument-apps-otel,Get started with an OpenTelemetry API/SDK →>>

image::images/apm-otel-api-sdk.png[]

[float]
[[apm-otel-api-sdk-elastic-agent]]
=== OpenTelemetry API/SDK + Elastic APM agent

Use the OpenTelemetry API/SDKs with Elastic APM agents to translate OpenTelemetry API calls to Elastic APM API calls.
This allows you to reuse your existing instrumentation to create Elastic APM transactions and spans--
avoiding vendor lock-in and having to redo manual instrumentation.

This is currently supported by the Java, Python, .NET, and Node.js agents.

<<apm-open-telemetry-with-elastic,Get started with an OpenTelemetry API/SDK + an Elastic APM agent →>>

image::images/apm-otel-api-sdk-elastic-agent.png[]

[float]
[[apm-otel-collector]]
=== OpenTelemetry collector

The {stack} natively supports the OpenTelemetry protocol (OTLP).
This means trace data and metrics collected from your applications and infrastructure by an
OpenTelemetry collector can be sent directly to the {stack}.

<<apm-connect-open-telemetry-collector,Get started with an OpenTelemetry collector →>>

image::images/apm-otel-collector.png[]

// TODO: Should this be reflected in the diagram, too?
[float]
[[apm-otel-lambda]]
=== Lambda collector exporter

AWS Lambda functions can be instrumented with OpenTelemetry and monitored with Elastic {observability}.

<<apm-open-telemetry-aws-lambda,Get started with a Lambda collector exporter →>>

include::./otel-with-elastic.asciidoc[]

include::./otel-direct.asciidoc[]

include::./otel-other.asciidoc[]

include::./otel-metrics.asciidoc[]

include::./otel-limitations.asciidoc[]

include::./otel-attrs.asciidoc[]

// ****
// The text below is used in the Quick start guide
// tag::otel-get-started[]
Elastic integrates with OpenTelemetry, allowing you to reuse your existing instrumentation
to easily send observability data to the {stack}.

For more information on how to combine Elastic and OpenTelemetry,
see {observability-guide}/apm-open-telemetry.html[OpenTelemetry integration].
// end::otel-get-started[]
// ****