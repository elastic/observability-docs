[[monitor-amazon-s3]]
= Monitor Amazon Simple Storage Service (S3)

++++
<titleabbrev>Monitor S3</titleabbrev>
++++

Amazon Simple Storage Service (S3) is an object storage service that offers
scalability, data availability, security, and performance. Amazon S3 stores data
as objects within buckets. An object consists of a file and optionally any
metadata that describes that file. Buckets are the containers for objects. You
can have one or more buckets. For each bucket, you can control access to it.

Like most AWS services, Amazon S3 and Amazon CloudWatch are integrated so you
can collect, view, and analyze CloudWatch metrics for your S3 buckets to help
understand and improve the performance of applications that use Amazon S3.
The Elastic {integrations-docs}/aws/s3[Amazon S3 integration] collects metrics
from Amazon CloudWatch using {agent}.

With the Amazon S3 integration, you can collect these S3 metrics from
CloudWatch:

* Daily storage metrics for buckets. Use these metrics to monitor bucket
storage. These metrics are reported once per day by default and are provided to
AWS customers at no additional cost.
* Request metrics. Use these metrics to quickly identify and act on
operational issues. These request metrics are available at one-minute intervals
after some latency for processing, and they are not enabled by default. 

[discrete]
[[get-started-s3]]
== Get started

If you plan to collect request metrics, enable them for the S3 buckets you want
to monitor. To learn how, refer to the
https://docs.aws.amazon.com/AmazonS3/latest/userguide/configure-request-metrics-bucket.html[AWS documentation].

To collect S3 logs and metrics, you typically need to install the Elastic
{integrations-docs}/aws/s3[Amazon S3 integration] and deploy an {agent}
locally or on an EC2 instance.

Expand the **quick guide** to learn how, or skip to the next section if your
data is already in {es}.

//Sets the integration name used in the quick guide
:integration-name: Amazon S3

include::{observability-docs-root}/docs/en/shared/integrations-quick-guide.asciidoc[]

//Clears the integration name
:integration-name!:

{agent} is currently the preferred way to add S3 logs and metrics. For other
ways, refer to {cloud}/ec-cloud-ingest-data.html[Adding data to {es}].

[discrete]
[[dashboard-s3]]
== Dashboards

{kibana-desc}
For example, to see an overview of your S3 metrics in {kib}, go to
the **Dashboard** app and navigate to the **[Metrics AWS] S3 Overview**
dashboard.

[role="screenshot"]
image::images/s3-dashboard.png[Screenshot showing the S3 dashboard]

[discrete]
== Metrics to watch

Here are the key metrics that you should watch, organized by category. For a
full list of fields exported by the integration, refer to the
{integrations-docs}/aws/s3[Amazon S3 integration] docs.

.Daily storage metrics for buckets
|===
| Field | Description | Unit | Type

| `aws.s3_daily_storage.number_of_objects`
| The number of objects stored in a bucket for all storage classes over the
specific time period. This value is calculated by counting all objects in the
bucket and the total number of parts for all incomplete multipart uploads to the
bucket.
| Count
| double

| `aws.s3_daily_storage.bucket.size.bytes`
| The average amount of data in bytes that is stored in a bucket. This value is calculated by summing the size of all objects and metadata in the bucket, including the size of all parts for all incomplete multipart uploads to the bucket.
| Bytes
| double
|===

.Request metrics
|===
| Field | Description | Unit | Type

| `aws.s3_request.requests.total`
| The total number of HTTP requests made to an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.get`
| The total number of HTTP GET requests made for objects in an Amazon S3 bucket. This does not include list operations.
| Count
| long

| `aws.s3_request.requests.put`
| The total number of HTTP PUT requests made for objects in an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.delete`
| The total number of HTTP DELETE requests made for objects in an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.head`
| The total number of HTTP HEAD requests made to an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.post`
| The total number of HTTP POST requests made to an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.select`
| The total number of Amazon S3 SELECT Object Content requests made for objects in an Amazon S3 bucket.
| Count
| long

| `aws.s3_request.requests.list`
| The total number of HTTP request that list the contents of a bucket.
| Count
| long

| `aws.s3_request.requests.select_scanned.bytes`
| The average number of bytes of data scanned per Amazon S3 SELECT Object Content requests in an Amazon S3 bucket.
| Bytes
| double

| `aws.s3_request.requests.select_returned.bytes`
| The average number of bytes of data returned per Amazon S3 SELECT Object Content requests in an Amazon S3 bucket.
| Bytes
| double

| `aws.s3_request.downloaded.bytes`
| The average number of bytes downloaded per request made to an Amazon S3 bucket, where the response includes a body.
| Bytes
| double

| `aws.s3_request.uploaded.bytes`
| The average number of bytes uploaded per request made to an Amazon S3 bucket, where the response includes a body.
| Bytes
| double

| `aws.s3_request.downloaded.bytes_per_period`
| The total number of bytes downloaded per period for requests made to an Amazon S3 bucket, where the response includes a body.
| Bytes
| double

| `aws.s3_request.uploaded.bytes_per_period`
| The total number of bytes uploaded per period for requests made to an Amazon S3 bucket, where the response includes a body.
| Bytes
| double

| `aws.s3_request.errors.4xx`
| The average number of HTTP 4xx client error status code requests made to an Amazon S3 bucket over the specific time period.
| Count
| double

| `aws.s3_request.errors.5xx`
| The average number of HTTP 5xx client error status code requests made to an Amazon S3 bucket over the specific time period.
| Count
| double

| `aws.s3_request.latency.first_byte.ms`
| The average pre-request time from the complete request being received by an Amazon S3 bucket to when the response starts to be returned.
| Milliseconds
| double

| `aws.s3_request.latency.total_request.ms`
| The average elapsed per-request time from the first byte received to the last byte sent to an Amazon S3 bucket.
| Milliseconds
| double
|===
