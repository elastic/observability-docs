---
id: serverlessObservabilityApmAgentsJaeger
slug: /serverless/observability/apm-agents-jaeger
title: Jaeger
# description: Description to be written
tags: [ 'serverless', 'observability', 'reference' ]
status: rough content
---

import RoughContent from '../partials/rough-content-notice.mdx'

<RoughContent />

import TabWidgetsJaegerWidget from '../transclusion/apm/guide/tab-widgets/jaeger-widget.mdx'

<div id="jaeger-integration"></div>

Elastic APM integrates with [Jaeger](https://www.jaegertracing.io/), an open-source, distributed tracing system.
This integration allows users with an existing Jaeger setup to switch from the default Jaeger backend,
to the ((stack)).
Best of all, no instrumentation changes are needed in your application code.

<div id="jaeger-architecture"></div>

## Supported architecture

Jaeger architecture supports different data formats and transport protocols
that define how data can be sent to a collector. Elastic APM, as a Jaeger collector,
supports communication with **Jaeger agents** via gRPC.

* The APM integration serves Jaeger gRPC over the same host and port as the Elastic ((apm-agent)) protocol.

* The APM integration gRPC endpoint supports TLS. If SSL is configured,
    SSL settings will automatically be applied to the APM integration's Jaeger gRPC endpoint.

* The gRPC endpoint supports probabilistic sampling.
    Sampling decisions can be configured <DocLink id="serverlessObservabilityApmAgentsJaeger" section="((apm-agent))-central-configuration-default">centrally</DocLink> with ((apm-agent)) central configuration, or <DocLink id="serverlessObservabilityApmAgentsJaeger" section="local-sampling-in-each-jaeger-client">locally</DocLink> in each Jaeger client.

See the [Jaeger docs](https://www.jaegertracing.io/docs/1.27/architecture)
for more information on Jaeger architecture.

<div id="get-started-jaeger"></div>

## Get started

Connect your preexisting Jaeger setup to Elastic APM in three steps:

* <DocLink id="serverlessObservabilityApmAgentsJaeger" section="configure-jaeger-agents">Configure Jaeger agents</DocLink>
* <DocLink id="serverlessObservabilityApmAgentsJaeger" section="configure-sampling">Configure Sampling</DocLink>
* <DocLink id="serverlessObservabilityApmAgentsJaeger" section="start-sending-data">Start sending data</DocLink>

<DocCallOut title="Important" color="warning">
There are <DocLink id="serverlessObservabilityApmAgentsJaeger" section="caveats">caveats</DocLink> to this integration.
</DocCallOut>

<div id="configure-agent-client-jaeger"></div>

### Configure Jaeger agents

The APM integration serves Jaeger gRPC over the same host and port as the Elastic ((apm-agent)) protocol.

<TabWidgetsJaegerWidget />

<div id="configure-sampling-jaeger"></div>

### Configure Sampling

The APM integration supports probabilistic sampling, which can be used to reduce the amount of data that your agents collect and send.
Probabilistic sampling makes a random sampling decision based on the configured sampling value.
For example, a value of `.2` means that 20% of traces will be sampled.

There are two different ways to configure the sampling rate of your Jaeger agents:

* <DocLink id="serverlessObservabilityApmAgentsJaeger" section="((apm-agent))-central-configuration-default">((apm-agent)) central configuration (default)</DocLink>
* <DocLink id="serverlessObservabilityApmAgentsJaeger" section="local-sampling-in-each-jaeger-client">Local sampling in each Jaeger client</DocLink>

<div id="configure-sampling-central-jaeger"></div>

#### ((apm-agent)) central configuration (default)

Central sampling, with ((apm-agent)) central configuration,
allows Jaeger clients to poll APM Server for the sampling rate.
This means sample rates can be configured on the fly, on a per-service and per-environment basis.
See [Central configuration](((kibana-ref))/agent-configuration.html) to learn more.

<div id="configure-sampling-local-jaeger"></div>

#### Local sampling in each Jaeger client

If you don't have access to the ((apm-app)),
you'll need to change the Jaeger client's `sampler.type` and `sampler.param`.
This enables you to set the sampling configuration locally in each Jaeger client.
See the official [Jaeger sampling documentation](https://www.jaegertracing.io/docs/1.27/sampling/)
for more information.

<div id="configure-start-jaeger"></div>

### Start sending data

That's it! Data sent from Jaeger clients to the APM Server can now be viewed in the ((apm-app)).

<div id="caveats-jaeger"></div>

## Caveats

There are some limitations and differences between Elastic APM and Jaeger that you should be aware of.

**Jaeger integration limitations:**

* Because Jaeger has its own trace context header, and does not currently support W3C trace context headers,
    it is not possible to mix and match the use of Elastic's APM agents and Jaeger's clients.

* Elastic APM only supports probabilistic sampling.

**Differences between APM Agents and Jaeger Clients:**

* Jaeger clients only sends trace data.
    APM agents support a larger number of features, like
    multiple types of metrics, and application breakdown charts.
    When using Jaeger, features like this will not be available in the ((apm-app)).

* Elastic APM's <DocLink id="serverlessObservabilityApmDataModel">Data Model</DocLink> is different than Jaegers.
    For Jaeger trace data to work with Elastic's data model, we rely on spans being tagged with the appropriate
    [`span.kind`](https://github.com/opentracing/specification/blob/master/semantic_conventions.md).

    * Server Jaeger spans are mapped to Elastic APM <DocLink id="serverlessObservabilityApmSpansTransactionsErrorsMetricsMetadata">Transactions</DocLink>.
    * Client Jaeger spans are mapped to Elastic APM <DocLink id="serverlessObservabilityApmSpansTransactionsErrorsMetricsMetadata">Spans</DocLink> -- unless the span is the root, in which case it is mapped to an Elastic APM <DocLink id="serverlessObservabilityApmSpansTransactionsErrorsMetricsMetadata">Transactions</DocLink>.

